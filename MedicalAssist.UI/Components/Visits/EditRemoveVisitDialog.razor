@using MedicalAssist.UI.Models.Visits


<MudDialog TitleClass="text-center">
	<DialogContent>
		<MudForm @ref="form" Model="@_visitModel" Validation="@(_validator.ValidateValue)" ValidationDelay="80">
			<MudGrid>
				<MudItem xs="12" sm="6">
					<MudTextField Label="@Translations.DoctorName" 
						@bind-Value="_visitModel.DoctorName" 
						ReadOnly="@_readOnlyMode" 
						For = "@(()=> _visitModel.DoctorName)"/>
				</MudItem>
				<MudItem xs="12" sm="6">
					<MudTextField Label="@Translations.VisitType" @bind-Value="_visitModel.VisitType" ReadOnly="@_readOnlyMode" 
						For ="@(() => _visitModel.VisitType)"/>
				</MudItem>
				<MudItem xs="12">
					<MudTextField Label="@Translations.Description" @bind-Value="_visitModel.VisitDescription" AutoGrow MaxLines="3"
									  ReadOnly="@_readOnlyMode" For ="@(() => _visitModel.VisitDescription)" />
					</MudItem>
					<MudItem xs="12">
						<MudTextField Label="@Translations.Street" @bind-Value="_visitModel.Street" ReadOnly="@_readOnlyMode" 
							For="@(() => _visitModel.Street)"/>
					</MudItem>
					<MudItem xs="12" sm="6">
						<MudTextField Label="@Translations.PostalCode" @bind-Value="_visitModel.PostalCode" Mask="@postalCodeMask"
									  ReadOnly="@_readOnlyMode" For="@(() => _visitModel.PostalCode)"/>
					</MudItem>
					<MudItem xs="12" sm="6">
						<MudTextField Label="@Translations.City" @bind-Value="_visitModel.City" ReadOnly="@_readOnlyMode"
									  For="@(() => _visitModel.City)" />
					</MudItem>
					<MudItem xs="12" sm="4">
						<MudDatePicker PickerVariant="PickerVariant.Dialog" Label="@Translations.Date" Editable="true" @bind-Date="_visitModel.Date"
									   Mask="@(new DateMask("dd/MM/yyyy"))" DateFormat="dd/MM/yyyy" Placeholder="dd/MM/yyyy"
									   ReadOnly="@_readOnlyMode" For="@(() => _visitModel.Date)" />
					</MudItem>
					<MudItem xs="12" sm="4">
						<MudTimePicker PickerVariant="PickerVariant.Dialog" Label="@Translations.Time" @bind-Time="_visitModel.Time" ReadOnly="@_readOnlyMode"
									   For="@(() => _visitModel.Time)" />
					</MudItem>
					<MudItem xs="12" sm="4">
						<MudTextField T="TimeSpan?" Label="@Translations.VisitPredictedTime" InputType="InputType.Time" @bind-Value="_visitModel.PredictedEndDate"
									  ReadOnly="@_readOnlyMode" For="@(() => _visitModel.PredictedEndDate)" />
					</MudItem>
				</MudGrid>
			</MudForm>
		</DialogContent>
		<DialogActions>
			<MudButton OnClick="@( async () =>  await BtnPressed())" Variant="MudBlazor.Variant.Filled"
					   Color="Color.Primary" Disabled="@_btnPressed">@(!_isEditMode ? Translations.GoToEditMode : Translations.Edit )</MudButton>
			<MudButton OnClick="@( async () => await DeleteVisit())" Variant="MudBlazor.Variant.Filled"
					   Color="Color.Error">@Translations.Delete </MudButton>
			<MudButton OnClick="Cancel" Variant="MudBlazor.Variant.Filled">@Translations.Cancel</MudButton>
		</DialogActions>
	</MudDialog>